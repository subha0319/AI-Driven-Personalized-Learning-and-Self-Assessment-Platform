# -*- coding: utf-8 -*-
"""PW2 BERT for quiz.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1-BAxlXm5FbawGZNAI2qfAX6r6Nj88VUL
"""

from sentence_transformers import SentenceTransformer
from sklearn.metrics.pairwise import cosine_similarity

# Load pre-trained BERT model
model = SentenceTransformer('all-MiniLM-L6-v2')  # A lightweight BERT variant for sentence embeddings

def evaluate_quizzes(user_topics, generated_material, quiz_questions, topic_threshold=0.4, content_threshold=0.2):
    # Encode user topics, generated material, and quiz questions
    topic_embeddings = model.encode(user_topics)
    quiz_embeddings = model.encode(quiz_questions)
    content_embeddings = model.encode([generated_material])  # Encode material as a single document

    # Check if each topic has at least one relevant quiz
    topic_coverage = {}
    for i, topic in enumerate(user_topics):
        similarities = cosine_similarity([topic_embeddings[i]], quiz_embeddings)[0]
        max_similarity = max(similarities)
        topic_coverage[topic] = max_similarity >= topic_threshold

    # Check if each quiz is relevant to the generated material
    quiz_relevance = {}
    for i, quiz in enumerate(quiz_questions):
        similarity = cosine_similarity([quiz_embeddings[i]], content_embeddings)[0][0]
        quiz_relevance[quiz] = similarity >= content_threshold

    # Results
    uncovered_topics = [topic for topic, covered in topic_coverage.items() if not covered]
    irrelevant_quizzes = [quiz for quiz, relevant in quiz_relevance.items() if not relevant]

    return {
        "topic_coverage": topic_coverage,
        "uncovered_topics": uncovered_topics,
        "quiz_relevance": quiz_relevance,
        "irrelevant_quizzes": irrelevant_quizzes
    }

# Sample Inputs
user_topics = ["Artificial Intelligence", #also referred as AI, will cosine similarity consider "AI" and "Artificial Intelligence" same or different?
    "Intelligent Agents",
    "Rational Agent",
    "Nature of Environments",
    "Structure of Agents",

    #Irrelevant Topics
    "Operating systems",
    "Business analysis"
    ]
generated_material = [
    "Introduction to Artificial Intelligence:"
    "Artificial Intelligence (AI) refers to the field of computer science dedicated to creating systems capable of performing tasks that typically require human intelligence, such as understanding natural language, recognizing patterns, solving problems, and making decisions. The goal of Artificial Intelligence is to develop machines that can simulate cognitive functions and act intelligently."

    "The State of the Art in Artificial Intelligence:"
    "Artificial Intelligence has made significant advancements in recent years, driven by developments in machine learning, neural networks, deep learning, and natural language processing. Artificial Intelligence applications are now prevalent in various domains, including healthcare, finance, autonomous vehicles, robotics, and customer service. The state of the art is characterized by models that are capable of learning from vast amounts of data and making real-time decisions with high accuracy."

    "Intelligent Agents:"
    "An intelligent agent is any entity that can perceive its environment through sensors and take actions through actuators to achieve its goals. Intelligent agents can be as simple as a thermostat or as complex as self-driving cars. The key features of intelligent agents include perception, reasoning, and action. Intelligent agents can function autonomously, adapt to new situations, and improve their performance over time."

    "Rational Agent:"
    "In the context of Artificial Intelligence, rationality refers to the ability of an agent to make decisions that maximize its expected performance based on its goals and the available information. A rational agent always chooses the action that is expected to lead to the best possible outcome. Rationality does not necessarily mean that an agent has to act in human-like ways, but rather that it acts in the best interest of achieving its objectives."

    "Nature of Environments:"
    "The environment in which an agent operates can vary in complexity, uncertainty, and changeability. The nature of the environment plays a crucial role in determining how the agent perceives the world and decides on actions. Environments can be:"

    "Fully Observable vs. Partially Observable: Whether the agent has access to complete or partial information."
    "Deterministic vs. Stochastic: Whether the outcome of actions is predictable or probabilistic."
    "Static vs. Dynamic: Whether the environment changes while the agent is making decisions."
    "Discrete vs. Continuous: Whether the environment is composed of distinct states or operates on continuous variables."

    "Structure of Agents:"
    "The structure of intelligent agents involves several components that work together to achieve the agent's goals. The key components include:"

    "Sensors: These allow the agent to perceive the environment."
    "Actuators: These allow the agent to perform actions in the environment."
    "Reasoning Mechanism: This is responsible for decision-making, which can be based on logic, rules, or learning algorithms.",
    "Performance Measure: This quantifies the success of an agent's actions in achieving its goals.",
    "Knowledge Base: The information the agent uses to understand the environment and make decisions.",

    "Conclusion:"
    "The first unit of Artificial Intelligence introduces the foundational concepts that define intelligent systems. It highlights the importance of intelligent agents, rational decision-making, and understanding the environment in which these agents operate. Understanding these concepts provides the groundwork for building more advanced Artificial Intelligence systems capable of tackling real-world problems."
]
quiz_questions = [
    "What is the primary goal of Artificial Intelligence?",
    "Which of the following is NOT a typical application of Artificial Intelligence?",
    "What defines an intelligent agent in AI?",
    "Which component is NOT typically part of an intelligent agent?",
    "In the context of Artificial Intelligence, what is a rational agent?",
    "Which of the following is a key feature of a rational agent?",
    "Which of the following is a key feature of a rational agent?",
    "Which of the following is a partially observable environment in the context of AI?",
    "In the context of AI, a dynamic environment means:",
    "What are the basic components of an intelligent agent's structure?",
    "In an intelligent agent, which of the following components is responsible for interpreting sensory",

    #Irrelevant quizes:
    "What is the capital of France?",
    "Which of these animals can fly?",
    "What is the largest ocean on Earth?",
    "What is the main ingredient in guacamole?"

]

# Run Evaluation
results = evaluate_quizzes(user_topics, generated_material, quiz_questions)

# Print Results
print("Uncovered Topics:", results['uncovered_topics'])
print("Irrelevant Quizzes:", results['irrelevant_quizzes'])
print("\nTopic Coverage:")
for topic, covered in results['topic_coverage'].items():
    print(f"- {topic}: {'Covered' if covered else 'Not Covered'}")

print("\nQuiz Relevance:")
for quiz, relevant in results['quiz_relevance'].items():
    print(f"- {quiz}: {'Relevant' if relevant else 'Irrelevant'}")